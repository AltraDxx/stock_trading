# QuantumAlpha: AI 原生量化投研决策系统开发规划书

## 1. 产品愿景 (Vision)
打造一款机构级精度的跨平台桌面端智能投研工作台（Desktop App, 支持 Windows/macOS）。本项目旨在通过 **大语言模型（LLM）** 与 **传统量化因子模型** 的深度融合，将 `idea.md` 中定义的复杂多因子研究框架自动化，为用户提供"黑盒化"的阿尔法（Alpha）挖掘与"白盒化"的深度归因分析。

## 2. 系统架构与核心模块

本系统基于 **RAG（检索增强生成）** 与 **Agentic Workflow（代理工作流）** 架构，支持**定时任务**与**实时交互**双模式驱动。

### 模块 A：Alpha Predator（全市场阿尔法捕获/每日早盘推）
**定位**：全视角策略扫描引擎。支持 **每日早盘定时推** 与 **用户按需实时推**。

*   **双阶段时效优化 (Two-Stage Pipeline)**：为应对 9:30 的极限时限，报告生成将拆分为两步：
    1.  **预处理阶段 (Pre-processing, 9:00-9:15)**：提前完成宏观数据、隔夜外盘、昨日技术形态及新闻舆情的分析，生成报告的 "80% 静态框架"。
    2.  **增量更新阶段 (Incremental Update, 9:25-9:30)**：集合竞价结束后，仅将 "今日开盘价"、"竞价量能"、"封单额" 等核心动态参数注入 Prompt，请求 Gemini 仅对 *最终策略建议* 部分进行快速修正与生成。

*   **容灾与降级方案 (Fallback Strategy)**：
    *   **Plan B (API 超时)**：若到达熔断时间（初始值为9:29:30，允许用户自定义）时 Gemini 仍未返回结果，系统自动触发熔断，转为 **规则引擎 (Rule-based)** 模式。直接输出基于硬编码逻辑计算的 "竞价异动榜单"（如：高开 > 3% 且 量比 > 5 的板块/个股），放弃自然语言润色，确保 9:30 前核心数据绝对触达。
    *   **Plan C (数据源故障)**：若集合竞价数据缺失，回退至 "昨日收盘策略"，并显著标记 "基于昨日数据" 的风险提示。

*   **数据流 (Data Pipeline)**：
    1.  **宏观与资金面**：抓取 OMO、Shibor、隔夜外盘表现。
    2.  **技术面共振**：结合 `9:15-9:25` 的集合竞价数据，预判今日开盘情绪（高开/低开/核按钮）。
    3.  **舆情分析**：实时处理盘前突发新闻。

*   **输出与通知 (Output & Notification)**：
    *   生成结构化交易建议（同 `sample.md`）。
    *   **多渠道触达**：分析完成后，系统自动通过 **Webhook (飞书/钉钉)** 或 **Email** 发送核心策略摘要。

### 模块 B：Deep Dive Diagnostic（个股深度诊疗/用户被动查）
**定位**：交互式问答服务。用户输入特定代码，系统调用量化模型进行"体检"。

*   **分析维度**：
    1.  **行业地位**：Alpha/Beta 分离度分析。
    2.  **多因子评分**：价值、成长、动量雷达图。
    3.  **事件驱动**：解禁、减持、重组监控。
*   **输出内容**：
    1.  **多空信号**：Buy / Hold / Sell 评级。
    2.  **阻力与支撑**：基于 Level-2 筹码分布。
    3.  **情景推演**：上涨逻辑 vs 下跌风险。

## 3. 用户体验设计 (UX/UI Design)

界面设计适配桌面端操作习惯，强调多窗口并行与数据可视化。

1.  **Dashboard（指挥舱）**
    *   **分屏布局**：左侧为策略导航与历史记录，中间为核心研报阅读区，右侧为实时行情组件。
    *   **快捷指令**：支持 `Ctrl+K` 快速调起个股诊断或策略搜索。
    *   **状态栏**：实时显示 "距离开盘时间" 或 "分析任务进度/通知发送状态"。

2.  **交互式研报详情页**
    *   **结构化呈现**：核心结论置顶，细节逻辑折叠。
    *   **图文联动**：点击逻辑锚点，K 线图自动缩放至对应技术形态区域。
    *   **导出与分享**：支持 Markdown 源码导出、PDF 生成及 Webhook 测试推送。

## 4. Prompt Engineering 策略

作为系统的"大脑"，Prompt 将扮演首席分析师的角色。我们将采用 **Chain-of-Thought (CoT)** 和 **Role-Playing** 技术：

*   **Role**: "你是一名为顶级对冲基金工作的资深量化研究员，擅长结合宏观流动性与微观技术形态。"
*   **Constraint**: "输出必须严格遵循 Markdown 格式，所有结论必须有数据支撑（引用数据源），拒绝模棱两可的废话。"
*   **Task**: "结合 `idea.md` 中的数据输入，尤其是 **9:15-9:25 的集合竞价特征**，分析当前市场环境，并依照 `sample.md` 的风格生成研报。"

## 5. 开发路线图 (Roadmap)

1.  **Phase 1 (Data Layer)**: 搭建 Python 数据中台，接入 Tushare/AkShare，重点攻克 **集合竞价数据** 的实时获取。
2.  **Phase 2 (Model Layer)**: 编写 TA-Lib 技术指标脚本，集成 NLP 模型，实现 Webhook/SMTP 通知服务。
3.  **Phase 3 (App Layer)**: 使用 **Electron / Tauri** 开发跨平台桌面客户端，集成 Python 后端。